<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simple WebRTC Call - Dune x Nigeria</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }

    video {
      width: 300px;
      height: 200px;
      background: #000;
      margin: 10px;
      border: 2px solid #333;
    }

    input {
      width: 200px;
      padding: 5px;
      margin-right: 5px;
    }

    button {
      padding: 5px 10px;
    }
  </style>
</head>
<body>
  <h1>Simple WebRTC Video Call</h1>

  <div>
    <h2>Your Video</h2>
    <video id="localVideo" autoplay muted playsinline></video>
  </div>

  <div>
    <h2>Remote Video</h2>
    <video id="remoteVideo" autoplay playsinline></video>
  </div>

  <div>
    <label>Enter Peer ID to call:</label>
    <input type="text" id="peerIdInput" placeholder="Peer ID">
    <button id="callButton">Call</button>
  </div>

  <div>
    <p>Your Peer ID: <span id="myId">...</span></p>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/peerjs@1.4.7/dist/peerjs.min.js"></script>
  <script>
    const localVideo = document.getElementById('localVideo');
    const remoteVideo = document.getElementById('remoteVideo');
    const callButton = document.getElementById('callButton');
    const peerIdInput = document.getElementById('peerIdInput');
    const myIdSpan = document.getElementById('myId');

    let localStream;

    // Words from the Dune universe
    const duneWords = [
      "Arrakis", "Fremen", "Sietch", "ShaiHulud", "Spice", 
      "BeneGesserit", "Kwizatz", "Harkonnen", "Atreides", "MuadDib"
    ];

    // Places in Nigeria
    const nigeriaPlaces = [
      "Lagos", "Abuja", "Kano", "Ibadan", "PortHarcourt", 
      "Enugu", "Kaduna", "Jos", "Benin", "Yola"
    ];

    // Generate random Peer ID
    function randomPeerId() {
      const word1 = duneWords[Math.floor(Math.random() * duneWords.length)];
      const word2 = nigeriaPlaces[Math.floor(Math.random() * nigeriaPlaces.length)];
      return `${word1}-${word2}`;
    }

    // Get camera/mic
    navigator.mediaDevices.getUserMedia({ video: true, audio: true })
      .then(stream => {
        localVideo.srcObject = stream;
        localStream = stream;
      })
      .catch(err => alert('Could not access camera/mic: ' + err));

    // Create PeerJS peer with human-friendly ID
    const peerId = randomPeerId();
    const peer = new Peer(peerId);

    peer.on('open', id => {
      myIdSpan.textContent = id;
      console.log('Your Peer ID:', id);
    });

    // Answer incoming calls
    peer.on('call', call => {
      call.answer(localStream);
      call.on('stream', remoteStream => {
        remoteVideo.srcObject = remoteStream;
      });
    });

    // Call button
    callButton.onclick = () => {
      const remoteId = peerIdInput.value.trim();
      if (!remoteId) return alert('Enter a Peer ID to call');
      const call = peer.call(remoteId, localStream);
      call.on('stream', remoteStream => {
        remoteVideo.srcObject = remoteStream;
      });
    };
  </script>
</body>
</html>
